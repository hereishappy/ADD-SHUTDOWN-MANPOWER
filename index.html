<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body class="p-4">
    <div class="max-w-md mx-auto space-y-6">
        <!-- Card 1: Add Employee -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="mb-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-2">Add Employee</h2>
                <div class="w-12 h-1 bg-blue-500 rounded"></div>
            </div>
            
            <form id="employeeForm" class="space-y-4">
                <div>
                    <input 
                        type="text" 
                        id="employeeName" 
                        placeholder="Employee Name"
                        class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all"
                        required
                    >
                </div>
                
                <button 
                    type="submit"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 transform hover:scale-[1.02]"
                >
                    Add Employee
                </button>
            </form>
            
            <div id="employeeStatus" class="mt-4 text-sm text-center hidden"></div>
        </div>

        <!-- Card 2: Add Supervisor -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="mb-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-2">Add Supervisor</h2>
                <div class="w-12 h-1 bg-purple-500 rounded"></div>
            </div>
            
            <form id="supervisorForm" class="space-y-4">
                <div>
                    <input 
                        type="text" 
                        id="supervisorName" 
                        placeholder="Supervisor Name"
                        class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition-all"
                        required
                    >
                </div>
                
                <div>
                    <input 
                        type="password" 
                        id="supervisorPassword" 
                        placeholder="4-Digit Password"
                        maxlength="4"
                        pattern="[0-9]{4}"
                        class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition-all"
                        required
                    >
                </div>
                
                <button 
                    type="submit"
                    class="w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 transform hover:scale-[1.02]"
                >
                    Add Supervisor
                </button>
            </form>
            
            <div id="supervisorStatus" class="mt-4 text-sm text-center hidden"></div>
        </div>

        <!-- Setup Instructions -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <div class="text-sm text-blue-800">
                <strong>Setup Instructions:</strong>
                <ol class="mt-2 ml-4 list-decimal space-y-1">
                    <li>Go to <a href="https://script.google.com" class="underline text-blue-600">script.google.com</a></li>
                    <li>Create new project and paste the Google Apps Script code below</li>
                    <li>Deploy as web app with "Anyone" access</li>
                    <li>Copy the web app URL and update the SCRIPT_URL below</li>
                </ol>
            </div>
        </div>

        <!-- Google Apps Script Code -->
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
            <div class="flex justify-between items-center mb-3">
                <h3 class="font-semibold text-gray-800">Google Apps Script Code</h3>
                <button onclick="copyToClipboard('gasCode')" class="text-blue-600 hover:text-blue-800 text-sm">Copy</button>
            </div>
            <pre id="gasCode" class="text-xs bg-white p-3 rounded border overflow-x-auto"><code>function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const sheetId = '1Cm1tisaD_dhRcmE5eO7_wf-OUnUVvhuH8mJrz_SAabo';
    const ss = SpreadsheetApp.openById(sheetId);
    
    if (data.sheet === 'EMP LIST') {
      const sheet = ss.getSheetByName('EMP LIST');
      if (!sheet) {
        const newSheet = ss.insertSheet('EMP LIST');
        newSheet.getRange('A1').setValue('EMP NAME');
      }
      const targetSheet = ss.getSheetByName('EMP LIST');
      const lastRow = targetSheet.getLastRow();
      const nextRow = lastRow === 0 ? 2 : lastRow + 1;
      targetSheet.getRange(nextRow, 1).setValue(data.values[0][0]);
      
    } else if (data.sheet === 'CONFIG') {
      const sheet = ss.getSheetByName('CONFIG');
      if (!sheet) {
        const newSheet = ss.insertSheet('CONFIG');
        newSheet.getRange('A1').setValue('Supervisor Name');
        newSheet.getRange('B1').setValue('Password');
      }
      const targetSheet = ss.getSheetByName('CONFIG');
      const lastRow = targetSheet.getLastRow();
      const nextRow = lastRow === 0 ? 2 : lastRow + 1;
      targetSheet.getRange(nextRow, 1, 1, 2).setValues([data.values[0]]);
    }
    
    return ContentService
      .createTextOutput(JSON.stringify({success: true}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}</code></pre>
        </div>
    </div>

    <script>
        // Google Sheet configuration
        const SHEET_CONFIG = {
            sheetId: '1Cm1tisaD_dhRcmE5eO7_wf-OUnUVvhuH8mJrz_SAabo',
            employeeSheet: 'EMP LIST',
            configSheet: 'CONFIG'
        };

        // Replace this with your Google Apps Script web app URL after deployment
        const SCRIPT_URL = 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE';

        // Employee form handler
        document.getElementById('employeeForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const employeeName = document.getElementById('employeeName').value.trim();
            const statusDiv = document.getElementById('employeeStatus');
            
            if (!employeeName) {
                showStatus(statusDiv, 'Please enter an employee name', 'error');
                return;
            }

            // Show loading state
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Adding...';
            submitBtn.disabled = true;

            try {
                // In a real implementation, this would call your Google Apps Script web app
                const data = {
                    sheet: SHEET_CONFIG.employeeSheet,
                    values: [[employeeName]],
                    range: 'A2' // Starting from A2 as requested
                };

                // Call Google Apps Script
                await callGoogleScript(data);
                
                showStatus(statusDiv, `Employee "${employeeName}" added successfully!`, 'success');
                document.getElementById('employeeName').value = '';
                
            } catch (error) {
                showStatus(statusDiv, 'Error adding employee. Please try again.', 'error');
                console.error('Error:', error);
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        // Supervisor form handler
        document.getElementById('supervisorForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const supervisorName = document.getElementById('supervisorName').value.trim();
            const password = document.getElementById('supervisorPassword').value;
            const statusDiv = document.getElementById('supervisorStatus');
            
            if (!supervisorName || !password) {
                showStatus(statusDiv, 'Please fill in all fields', 'error');
                return;
            }

            if (!/^\d{4}$/.test(password)) {
                showStatus(statusDiv, 'Password must be exactly 4 digits', 'error');
                return;
            }

            // Show loading state
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Adding...';
            submitBtn.disabled = true;

            try {
                // In a real implementation, this would call your Google Apps Script web app
                const data = {
                    sheet: SHEET_CONFIG.configSheet,
                    values: [[supervisorName, password]],
                    range: 'A:B' // Supervisor Name | Password columns
                };

                // Call Google Apps Script
                await callGoogleScript(data);
                
                showStatus(statusDiv, `Supervisor "${supervisorName}" added successfully!`, 'success');
                document.getElementById('supervisorName').value = '';
                document.getElementById('supervisorPassword').value = '';
                
            } catch (error) {
                showStatus(statusDiv, 'Error adding supervisor. Please try again.', 'error');
                console.error('Error:', error);
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        // Utility functions
        function showStatus(element, message, type) {
            element.textContent = message;
            element.className = `mt-4 text-sm text-center ${type === 'success' ? 'text-green-600' : 'text-red-600'}`;
            element.classList.remove('hidden');
            
            setTimeout(() => {
                element.classList.add('hidden');
            }, 3000);
        }

        async function callGoogleScript(data) {
            if (SCRIPT_URL === 'https://script.google.com/macros/s/AKfycbwT3RMC0uc4QCFcUd1YXPnaLCFugycdeQdt29DgJxRvHkSZisL9jeA28kx2bOE1122IVQ/exec') {
                throw new Error('Please update SCRIPT_URL with your Google Apps Script web app URL');
            }

            const response = await fetch(SCRIPT_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const result = await response.json();
            if (!result.success) {
                throw new Error(result.error || 'Unknown error occurred');
            }

            return result;
        }

        // Password input validation
        document.getElementById('supervisorPassword').addEventListener('input', function(e) {
            // Only allow numeric input
            this.value = this.value.replace(/[^0-9]/g, '');
        });

        // Copy to clipboard function
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                // Show temporary feedback
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.className = button.className.replace('text-blue-600', 'text-green-600');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.className = button.className.replace('text-green-600', 'text-blue-600');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy to clipboard');
            });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97a5574ba61dc464',t:'MTc1NzA3MTI2NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
